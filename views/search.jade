extends layout

block content

	.ui.grid

		.ui.sixteen.wide.column
			.ui.segment
				h1.ui.header Searching for: #{search}

		.ui.sixteen.wide.column
			.ui.segment
				h2.ui.header
					.content Controversy over time
				iframe(style="border:0px;" src="#{iframe}" height="200" width="100%")


			.ui.sixteen.wide.column(id='stats')
				.ui.segment
					h1.ui.header
						.content
							| Controversy Analysis Of The Articles About This Topic

					table.ui.definition.compact.table
						tbody
							tr
								td.two.wide.column Controversy
								td
									- var rounded = Math.round(stats.controversy * 100);
									- var red = 208 - Math.round(stats.controversy * (208 - 33));
									- var green = 208 - Math.round(stats.controversy * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="The confidence that the topic of this article is controversial is #{rounded}%.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{rounded}%
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon

							tr
								td.two.wide.column Actors
								td
									- stats.actors = Math.round(stats.actors)
									- var score = stats.actors / 100;
									if score > 1
										- score = 1
									- var rounded = Math.round(score * 100);
									- var red = 208 - Math.round(score * (208 - 33));
									- var green = 208 - Math.round(score * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="There are #{stats.actors} actors discussing the topic of this article. A controversy usually has many participating actors, indicating the size of the discussion.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{stats.actors}
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon


							tr
								td.two.wide.column Polarity
								td
									- var score = stats.polarity;
									- var view = Math.round(score * 100);
									if score > 1
										- score = 1
									- var rounded = Math.round(score * 100);
									- var red = 208 - Math.round(score * (208 - 33));
									- var green = 208 - Math.round(score * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="The polarity of the discussion on the topic of this article is #{rounded}%. The viewpoints in a controversy are usually polarized into grouped opposing camps.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{view}%
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon

							tr
								td.two.wide.column Openness
								td
									- stats.openness = Math.round(stats.openness)
									- var score = stats.openness / 200;
									if score > 1
										- score = 1
									if score < 0.05
										- score = 0.05
									- var rounded = Math.round(score * 100);
									- var red = 208 - Math.round(score * (208 - 33));
									- var green = 208 - Math.round(score * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="There are a total of #{stats.openness} comments related to the topic of this article. A controversy usually has many comments, as it plays out in an open space where people can easily join the discussion.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{stats.openness}
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon

							tr
								td.two.wide.column Time-Persistence
								td
									- stats.persistence = Math.round(stats.persistence)
									- var score = stats.persistence / 365;
									if score > 1
										- score = 1
									if score < 0.12
										- score = 0.12
									- var rounded = Math.round(score * 100);
									- var red = 208 - Math.round(score * (208 - 33));
									- var green = 208 - Math.round(score * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="The discussion of the topic in this article spans #{stats.persistence} days. A controversy usually persist over longer stretches of time.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{stats.persistence} days
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon

							tr
								td.two.wide.column Emotion
								td
									- var score = stats.emotion;
									- var view = Math.round(score * 100);
									- var rounded = Math.round(score * 100);
									- var red = 208 - Math.round(score * (208 - 33));
									- var green = 208 - Math.round(score * (208 - 133));
									- var blue = 208;
									.pop(data-title="Explanation", data-variation="small", data-content="Comments on the topic of this article on average have a sentimental strength of #{rounded}%. In a controversy usually strong sentiment is expressed, because values and beliefs are questioned.")
										.ui.active.progress(style="width:400px;margin:0px;display:inline-block;float:left;")
											.bar(style="width:#{rounded}%; background-color: rgb(#{red},#{green},#{blue})")
												.progress #{view}%
									.rate.pop(style="float:left;margin-left:20px;", data-variation="small", data-content="Let us know whether this was useful information or not.")
										i.positive.thumbs.outline.up.icon
										i.negative.thumbs.outline.down.icon



		if bottom[0]
			.ui.sixteen.wide.column.right.aligned
				a.ui.right.labeled.icon.orange.button(href='/browse/article/'+top[0]._id+'#annotate')
					i.right.arrow.icon
					| Tell us your perspective on an article


		.ui.sixteen.wide.column
			.ui.segment
				.ui.grid

					.ui.sixteen.wide.column.right.aligned
						.ui.pagination.menu
							.item Page
							- each p in pages
								if p == current
									a.item.active(href='?page='+p) #{p}
								else if p == '...'
									.item #{p}
								else
									a.item(href='?page='+p) #{p}

					.ui.eight.wide.column
						.ui.segment
							h2.ui.header
								.content Most Controversial Issues on "#{search}"
							- each article,i in top
								div(style='display:block;')
									- var rounded = Math.round(article._source.features.controversy.value * 100)
									- var red = 208 - Math.round(article._source.features.controversy.value * (208 - 33));
									- var green = 208 - Math.round(article._source.features.controversy.value * (208 - 133));
									- var blue = 208;
									.pop(style='float:right; margin-left:20px;', data-title="Explanation", data-variation="small", data-content="The confidence that the topic of this article is controversial is #{rounded}%.")
										div(class="ui active progress" style="width:100px")
											div(class="bar" style="width:#{rounded}px; background-color: rgb(#{red},#{green},#{blue})")
												div(class="progress") #{rounded}%
									a(href='/browse/article/'+article._id, style="") #{article._source.document.title}
								hr(style="clear:both")

					.ui.eight.wide.column
						.ui.segment
							h2.ui.header
								.content Least Controversial Issues on "#{search}"
							- each article,i in bottom
								div(style='display:block;')
									- var rounded = Math.round(article._source.features.controversy.value * 100)
									- var red = 208 - Math.round(article._source.features.controversy.value * (208 - 33));
									- var green = 208 - Math.round(article._source.features.controversy.value * (208 - 133));
									- var blue = 208;
									.pop(style='float:right; margin-left:20px;', data-title="Explanation", data-variation="small", data-content="The confidence that the topic of this article is controversial is #{rounded}%.")
										div(class="ui active progress" style="width:100px")
											div(class="bar" style="width:#{rounded}px; background-color: rgb(#{red},#{green},#{blue})")
												div(class="progress") #{rounded}%
									a(href='/browse/article/'+article._id, style="") #{article._source.document.title}
								hr(style="clear:both")

					.ui.sixteen.wide.column.right.aligned
						.ui.pagination.menu
							.item Page
							- each p in pages
								if p == current
									a.item.active(href='?page='+p) #{p}
								else if p == '...'
									.item #{p}
								else
									a.item(href='?page='+p) #{p}

